; multA.a
; from https://archive.org/details/BBCMicroCompendium/page/364/mode/2up
; (hiding in the BBC BASIC ROM at $9d83)
;
; 16 bit x 16 bit unsigned multiply, 32 bit result
; Average cycles:
; bytes


factorA  = $02          ; was $39
factorB  = $04          ; was $2a
product2 = $06          ; was $3f
product3 = $07          ; was $40

* = $0200

mult
    ldy #0
    ldx #0
    sty product2
    sty product3
-
    lsr factorA+1
    ror factorA
    bcc +

    clc
    tya
    adc factorB
    tay
    txa
    adc factorB+1
    tax
    lda product2
    adc factorB+2
    sta product2
    lda product3
    adc factorB+3
    sta product3

+
    asl factorB
    rol factorB+1
    rol factorB+2
    rol factorB+3

    lda factorA
    ora factorA+1
    bne -
    rts
